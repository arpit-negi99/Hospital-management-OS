{% extends 'base.html' %}
{% block title %}Edit Profile{% endblock %}
{% block content %}
<div class="row">
  <div class="col-md-6">
    <div class="card mb-3">
      <div class="card-header">Profile</div>
      <div class="card-body">
        <form method="post">
          <div class="mb-3">
            <label class="form-label">Name</label>
            <input name="name" class="form-control" value="{{ profile.name }}" />
          </div>
          <div class="mb-3">
            <label class="form-label">Department</label>
            <input name="department" class="form-control" value="{{ profile.department }}" />
          </div>
          <div class="mb-3">
            <label class="form-label">Year</label>
            <input name="year" class="form-control" value="{{ profile.year }}" />
          </div>
          <div class="mb-3">
            <label class="form-label">Contact</label>
            <input name="contact" class="form-control" value="{{ profile.contact or '' }}" />
          </div>
          <div class="mb-3">
            <label class="form-label">GPA</label>
            <input name="gpa" type="number" step="0.01" class="form-control" value="{{ profile.gpa or '' }}" />
          </div>
          <div class="mb-3">
            <label class="form-label">Resume URL</label>
            <input name="resume_url" class="form-control" value="{{ profile.resume_url or '' }}" />
          </div>
          <button class="btn btn-primary">Save</button>
        </form>
      </div>
    </div>
  </div>
  <div class="col-md-6">
    <div class="card">
      <div class="card-header">Skills</div>
      <div class="card-body">
        <form method="post" action="{{ url_for('student_update_skills') }}">
          <div class="mb-2">
            {% for s in all_skills %}
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="checkbox" id="skill{{ s.id }}" value="{{ s.id }}" {% if s in profile.skills %}checked{% endif %} onchange="updateSkillIds()">
                <label class="form-check-label" for="skill{{ s.id }}">{{ s.name }}</label>
              </div>
            {% endfor %}
          </div>
          <input type="hidden" name="skills" id="skillsField" />
          <button class="btn btn-outline-primary">Update Skills</button>
        </form>
      </div>
    </div>
  </div>
</div>
{% endblock %}
{% block scripts %}
<script>
  function updateSkillIds() {
    const ids = Array.from(document.querySelectorAll('input[type=checkbox][id^=skill]:checked')).map(el => el.value);
    document.getElementById('skillsField').value = ids.join(',');
  }
  updateSkillIds();
</script>
{% endblock %}
